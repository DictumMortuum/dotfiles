- name: Create dotfile structure
  hosts: all
  tasks:
    - file:
        path: "{{ item }}"
        state: directory
      loop:
        - "{{ thirdparty }}"
        - "{{ zsh_cache }}"
        - "{{ ansible_env.HOME }}/.local/share/qutebrowser/pdfjs"
        - "{{ ansible_env.HOME }}/.cache/zsh_completion"
        - "{{ ansible_env.HOME }}/.cache/screenlayout"
        - "{{ ansible_env.HOME }}/.local/bin"
        - "{{ ansible_env.HOME }}/.config/systemd/user"
        - "{{ ansible_env.HOME }}/.themes/"
        - "{{ ansible_env.HOME }}/.screenlayout/"
        - "{{ ansible_env.HOME }}/.cache/vim/"
        - "{{ ansible_env.HOME }}/.vim/"
        - "{{ ansible_env.HOME }}/.vim/bundle/"
        - "{{ ansible_env.HOME }}/.cache/ssh/"
        - "{{ ansible_env.HOME }}/.ssh/"

    - copy:
        src: "{{ secret }}/{{ item }}"
        dest: "{{ ansible_env.HOME }}/.ssh/{{ item }}"
        mode: 0600
      with_items:
        - id_rsa.pub
        - id_rsa

    - apt:
        name: "git"

    - user:
        name: dictummortuum
        group: dictummortuum
        create_home: True
